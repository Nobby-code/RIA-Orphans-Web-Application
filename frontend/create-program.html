<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Add Program</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="images/cropped-favicon-32x32.png"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />

    <!--CSS Plugins-->
    <link rel="stylesheet" href="css/plugin.css" />
    <!-- Default CSS-->
    <link rel="stylesheet" href="css/default.css" />
    <!--Custom CSS-->
    <link rel="stylesheet" href="css/styles.css" />

    <!-- Font Awesome 4.7.0 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <!-- Font Awesome 5 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
  </head>
  <style>
  /* Ensure input text is visible */
  .form-control,
  .form-control:focus {
    color: #212529 !important;          /* Dark text */
    background-color: #ffffff !important;
    border: 1px solid #ced4da !important; /* Visible border */
    box-shadow: none;
  }

  /* Placeholder text */
  .form-control::placeholder {
    color: #6c757d !important;
    opacity: 1;
  }

  /* Focus state */
  .form-control:focus {
    border-color: #0d6efd !important;   /* Bootstrap primary */
    box-shadow: 0 0 0 0.2rem rgba(13,110,253,.25);
  }

  label {
    color: #212529; /* Ensure labels are visible */
  }
</style>

  <body class="container mt-5">
    <!-- Header Section Start -->
    <div id="site-header"></div>
    <!-- Header Section End -->

    <h3>Add New Program</h3>

    <form id="programForm" enctype="multipart/form-data">
      <div class="mb-3">
        <label class="form-label">Title</label>
        <input type="text" id="title" class="form-control" required />
      </div>

      <div class="mb-3">
        <label class="form-label">Description</label>
        <textarea id="description" class="form-control" required></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label">Start Date</label>
        <input type="date" id="startDate" class="form-control" required />
      </div>

      <div class="mb-3">
        <label class="form-label">End Date</label>
        <input type="date" id="endDate" class="form-control" />
      </div>

      <div class="mb-3">
        <label class="form-label">Program Image</label>
        <input type="file" id="image" class="form-control" />
      </div>

      <!-- <button class="btn btn-success">Save Program</button> -->
      <button type="submit" id="submitBtn" class="btn btn-primary w-100">
        Add Program
      </button>
      <!-- <p id="formMessage" class="mt-3 text-center"></p> -->

      <!-- Success Modal -->
      <div
        class="modal fade"
        id="successModal"
        tabindex="-1"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header bg-success text-white">
              <h5 class="modal-title">Success</h5>
              <button
                type="button"
                class="btn-close btn-close-white"
                data-bs-dismiss="modal"
              ></button>
            </div>
            <div class="modal-body text-center">
              <p id="successMessage">Program added successfully!</p>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-success"
                data-bs-dismiss="modal"
              >
                OK
              </button>
            </div>
          </div>
        </div>
      </div>
    </form>

    <!-- Success Modal -->
    <div
      class="modal fade"
      id="successModal"
      tabindex="-1"
      aria-labelledby="successModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
          <div class="modal-header bg-success text-white">
            <h5 class="modal-title" id="successModalLabel">
              <i class="fas fa-check-circle me-2"></i> Success
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>

          <div class="modal-body text-center py-4">
            <p class="text-muted mb-0">
              The orphan record saved successfully!.
            </p>
          </div>

          <div class="modal-footer justify-content-center">
            <button
              type="button"
              class="btn btn-success px-4"
              data-bs-dismiss="modal"
            >
              OK
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0">
          <div class="modal-header bg-danger text-white">
            <h5 class="modal-title">
              <i class="fas fa-times-circle me-2"></i> Error
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body text-center">
            <p id="errorMessage" class="mb-0">
              Error occured while creating program
            </p>
          </div>
        </div>
      </div>
    </div>

    <script src="js/layout.js"></script>
    <script src="js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const API_URL = window.API_BASE_URL;
    //   const API_URL = "http://localhost:5000/api";
      const token = localStorage.getItem("token");

      document
        .getElementById("programForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const title = document.getElementById("title").value;
          const description = document.getElementById("description").value;
          const startDate = document.getElementById("startDate").value;
          const endDate = document.getElementById("endDate").value;
          const image = document.getElementById("image").files[0];

          const formData = new FormData();
          formData.append("title", title);
          formData.append("description", description);
          formData.append("startDate", startDate);
          formData.append("endDate", endDate);
          formData.append("image", image);

          try {
            const res = await fetch(`${API_URL}/programs`, {
              method: "POST",
              headers: {
                Authorization: `Bearer ${token}`,
              },
              body: formData,
            });

            const data = await res.json();

            if (res.ok) {
              const successModel = new bootstrap.Modal(
                document.getElementById("successModal")
              );
              document.getElementById("programForm").reset();
              successModel.show();
            } else {
              const errorModal = new bootstrap.Modal(
                document.getElementById("errorModal")
              );
              errorModal.show();
            }
          } catch (err) {
            console.error(err);
            console.log(err.message);

            const errorModal = new bootstrap.Modal(
              document.getElementById("errorModal")
            );
            errorModal.show();
          }
        });
    </script>
  </body>
</html>
