<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Search Result For: - RIA Orphans Foundation</title>

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="images/cropped-favicon-32x32.png"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css" />

    <!--CSS Plugins-->
    <link rel="stylesheet" href="css/plugin.css" />
    <!-- Default CSS-->
    <link rel="stylesheet" href="css/default.css" />
    <!--Custom CSS-->
    <link rel="stylesheet" href="css/styles.css" />

    <!-- Font Awesome 4.7.0 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <!-- Font Awesome 5 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />

    <!-- Lightbox2 CSS -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.5/css/lightbox.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header Section Start -->
    <div id="site-header"></div>
    <!-- Header Section End -->

    <!-- Breadcrumb Section Starts -->
    <section class="breadcrumb position-relative mb-0">
      <div class="overlay"></div>
      <div
        class="container text-center position-absolute top-50 start-50 translate-middle"
      >
        <h2 class="white mb-0">Orphans & Widows</h2>
      </div>
    </section>

    <!-- Orphans Section -->
    <section class="py-5">
      <div class="container">
        <div class="text-center mb-5">
          <!-- <h4 class="secondary">RIA Foundation Orphans & Widows</h4> -->
          <h4 class="secondary">
            Meet some of the orphans and widows whose lives need your support
          </h4>
          <p class="w-md-75 m-auto">
            <!-- RIA Orphans Foundation is managed by a dedicated team committed to
            our mission of supporting vulnerable children. Meet the individuals -->
            Orphans Listed below are in need of sponsorship and donations to
            help improve their lives.
          </p>
        </div>

        <div id="orphansSpinner" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-2">Loading orphans...</p>
        </div>
        <div class="row gy-4" id="orphansContainer"></div>
      </div>
      <div class="d-flex justify-content-center mt-4">
        <ul class="pagination" id="orphansPagination"></ul>
      </div>
    </section>
    <!-- Orphans Section Ends -->

    <!-- Widows Section -->

    <p class="w-md-75 m-auto">
      Widows Listed below are in need of donations to help improve their lives.
    </p>
    <section class="py-5 bg-light">
      <div id="widowsSpinner" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Loading widows...</p>
      </div>
      <div class="container widows-section" id="widowsContainer"></div>
      <div class="d-flex justify-content-center mt-4">
        <ul class="pagination" id="widowsPagination"></ul>
      </div>
    </section>

    <!-- Footer Starts -->
    <div id="site-footer"></div>
    <!-- Footer Ends -->

    <script src="js/layout.js"></script>
    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/plugin.js"></script>
    <script src="js/main.js"></script>
    <!-- <script src="js/api.js"></script>
    <script>
      async function loadOrphans() {
        const res = await getOrphans();

        const list = res.data; // <-- use the 'data' array

        const container = document.getElementById("orphansContainer");
        container.innerHTML = "";

        list.forEach((orphan) => {
          container.innerHTML += `
        <div class="col-lg-3 col-md-6">
          <div class="card shadow text-center border-0 member-card">
            <img src="${
              orphan.image || "images/default.jpg"
            }" class="card-img-top" />
            <div class="card-body">
              <h5 class="fw-bold">${orphan.name}</h5>
              <small class="text-muted">${orphan.gender}</small>
              <small class="text-muted">${orphan.age} years</small>
              <p class="mt-2 small">${orphan.description}</p>
              <a href="donation-form.html" class="btn btn-primary btn-sm mt-2">Donate</a>
            </div>
          </div>
        </div>
      `;
        });
      }

      loadOrphans();
    </script> -->

    <script src="js/api.js"></script>
    <script>
      async function loadOrphans(page = 1) {
        orphanCurrentPage = page;
        const spinner = document.getElementById("orphansSpinner");
        // spinner.style.display = "block";

        try {
          if (spinner) spinner.style.display = "block";
          document.getElementById("orphansPagination").style.pointerEvents =
            "none";
          const res = await getOrphans(page);
          if (spinner) spinner.style.display = "none";
          document.getElementById("orphansPagination").style.pointerEvents =
            "auto";
          if (!res.success) {
            console.error("Failed to fetch orphans");
            return;
          }

          const orphans = res.data;
          const container = document.getElementById("orphansContainer");
          container.innerHTML = "";

          if (orphans.length === 0) {
            container.innerHTML =
              "<p class='text-center'>No orphans available at the moment.</p>";
            return;
          }

          // ageInput.value = age >= 0 ? age : "";

          orphans.forEach((orphan) => {
            container.innerHTML += `
          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow text-center border-0 member-card h-100">
              <img src="${
                orphan.image ||
                "images/volunteer-holding-cardboard-box-2021-09-01-15-27-23-utc.jpg"
              }" class="card-img-top" alt="${orphan.name}">
              <div class="card-body d-flex flex-column">
                <h5 class="fw-bold">${orphan.name}</h5>
                <h5 class="fw-bold text-dark">${orphan.programNumber}</h5>
                <small class="text-muted">${orphan.gender}</small>
                <small class="text-muted">${orphan.age} years old</small>
                <p class="mt-2 small flex-grow-1">${
                  orphan.description || "No description provided."
                }</p>
                <a 
                  href="donation-form.html?type=orphan&id=${orphan._id}" 
                  class="btn btn-primary btn-sm mt-2">
                  Donate
                </a>
                <a 
                  href="sponsor-form.html?type=orphan&id=${orphan._id}" 
                  class="btn btn-outline-success btn-sm">
                  Sponsor
                </a>
              </div>
            </div>
          </div>
        `;
          });
          renderPagination("orphansPagination", res.pagination, loadOrphans);
          console.log("Loading orphans page:", page);
        } catch (error) {
          spinner.style.display = "none";
          console.error("Error loading orphans:", error);
        }
      }

      // Call function on page load
      loadOrphans();
    </script>
    <script>
      async function loadWidows(page = 1) {
        document.getElementById("widowsPagination").style.pointerEvents =
          "none";
        const spinner = document.getElementById("widowsSpinner");
        // spinner.style.display = "block";
        try {
          if (spinner) spinner.style.display = "block";
          const res = await getWidows(page);
          document.getElementById("widowsPagination").style.pointerEvents =
            "auto";
          if (spinner) spinner.style.display = "none";
          if (!res.success) {
            console.error("Failed to fetch widows");
            return;
          }

          const widows = res.data; // the array of widow objects
          console.log("Fetched widows:", widows);
          const container = document.getElementById("widowsContainer");
          container.innerHTML = "";

          if (widows.length === 0) {
            container.innerHTML =
              "<p class='text-center'>No widows available at the moment.</p>";
            return;
          }

          widows.forEach((widow) => {
            container.innerHTML += `
          <div class="col-lg-3 col-md-6 mb-4">
            <div class="card shadow text-center border-0 member-card h-100">
              <img src="${
                widow.image ||
                "images/volunteer-holding-cardboard-box-2021-09-01-15-27-23-utc.jpg"
              }" class="card-img-top" alt="${widow.name}">
              <div class="card-body d-flex flex-column">
                <h5 class="fw-bold">${widow.name}</h5>
                <small class="fw-bold">${widow.age} years</small>
                <small class="text-muted">${widow.gender}</small>
                <small class="text-muted">${
                  widow.numberOfChildren
                } children</small>
                <p class="mt-2 small flex-grow-1">${
                  widow.description || "No description provided."
                }</p>
                <a 
                  href="donation-form.html?type=widow&id=${widow._id}" 
                  class="btn btn-primary btn-sm mt-2">
                  Donate
                </a>
              </div>
            </div>
          </div>
        `;
          });
          renderPagination("widowsPagination", res.pagination, loadWidows);
        } catch (error) {
          console.error("Error loading widows:", error);
        }
      }

      // Call function on page load
      loadWidows();
    </script>
    <script>
      function renderPagination(containerId, pagination, callback) {
        const container = document.getElementById(containerId);
        container.innerHTML = "";

        const { currentPage, totalPages } = pagination;
        if (totalPages <= 1) return;

        // Previous
        const prev = document.createElement("li");
        prev.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
        prev.innerHTML = `<a class="page-link" href="#">Previous</a>`;
        prev.onclick = () => currentPage > 1 && callback(currentPage - 1);
        container.appendChild(prev);

        // Pages
        for (let i = 1; i <= totalPages; i++) {
          const li = document.createElement("li");
          li.className = `page-item ${i === currentPage ? "active" : ""}`;
          li.innerHTML = `<button type="button" class="page-link">${i}</button>`;
          li.onclick = () => callback(i);
          container.appendChild(li);
        }

        // Next
        const next = document.createElement("li");
        next.className = `page-item ${
          currentPage === totalPages ? "disabled" : ""
        }`;
        next.innerHTML = `<a class="page-link" href="#">Next</a>`;
        next.onclick = () =>
          currentPage < totalPages && callback(currentPage + 1);
        container.appendChild(next);
      }
    </script>
  </body>
</html>
